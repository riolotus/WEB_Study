(
    function() {
        var data1 = [{
                url: 'images/shangxian_1.jpg',
                point: '7.5',
                href: 'https://www.iqiyi.com/v_19rrhslnmz.html',
                title: '哆啦A梦：大雄的金银岛',
                message: '大雄的金银岛生活'
            }, {
                url: 'images/shangxian_2.jpg',
                point: '7.5',
                href: 'https://www.iqiyi.com/v_19rrhsln77.html',
                title: '哆啦A梦：大雄的金银岛',
                message: '大雄的金银岛生活'
            }, {
                url: 'images/shangxian_3.jpg',
                point: '7.1',
                href: 'http://www.iqiyi.com/v_19rrjdhrgs.html',
                title: '阿拉伯的劳伦斯',
                message: '沙漠枭雄威震中东'
            }, {
                url: 'images/shangxian_4.jpg',
                point: '7.4',
                href: 'http://www.iqiyi.com/v_19rrmycorg.html',
                title: '纳瓦隆大炮',
                message: '惊心动魄的冒险传奇'
            }, {
                url: 'images/shangxian_5.jpg',
                point: '8.5',
                href: 'http://www.iqiyi.com/v_19rrk3rde0.html',
                title: '查令十字街84号',
                message: '连接心灵的二十年书信'
            }, {
                url: 'images/shangxian_6.jpg',
                point: '7.0',
                href: 'http://www.iqiyi.com/v_19rrk3jznw.html',
                title: '20 30 40',
                message: '三代都市OL的爱情烦恼'
            }, {
                url: 'images/shangxian_7.jpg',
                point: '8.2',
                href: 'http://www.iqiyi.com/v_19rrk36544.html',
                title: '财神客栈 粤语',
                message: '财神客栈 粤语'
            }, {
                url: 'images/shangxian_8.jpg',
                point: '8.6',
                href: 'http://www.iqiyi.com/v_19rrjdhrgs.html',
                title: '门徒 粤语',
                message: '近距离接触涉毒人群'
            }, {
                url: 'images/shangxian_9.jpg',
                point: '6.8',
                href: 'http://www.iqiyi.com/v_19rrjaeajk.html',
                title: '新忠烈图',
                message: '吴奇隆经典武侠巨制'
            }, {
                url: 'images/shangxian_10.jpg',
                point: '7.8',
                href: 'http://www.iqiyi.com/v_19rrj5ufus.html',
                title: '江山美人',
                message: '冰美人放弃江山爱帅哥'
            }, {
                url: 'images/shangxian_11.jpg',
                point: '8.4',
                href: 'http://www.iqiyi.com/v_19rrjb7vkg.html',
                title: '我知女人心 粤语',
                message: '华仔巩俐演绎爱情经典'
            }, {
                url: 'images/shangxian_12.jpg',
                point: '7.8',
                href: 'http://www.iqiyi.com/v_19rrk8u164.html',
                title: '台北飘雪',
                message: '陈柏霖台湾文艺小清新'
            }, {
                url: 'images/shangxian_13.jpg',
                point: '8.3',
                href: 'http://www.iqiyi.com/v_19rrk22lgg.html',
                title: 'Hello！树先生',
                message: '犀利哥爱上聋哑村姑'
            }, {
                url: 'images/shangxian_14.jpg',
                point: '7.1',
                href: 'http://www.iqiyi.com/v_19rqyt3yas.html',
                title: '007：大战皇家赌场',
                message: '新邦德赌场陷危局'
            }

        ];
        var data2 = [{
                url: 'images/slide_1.jpg',
                point: '6.8',
                href: 'https://www.iqiyi.com/v_19rqy4u2lc.html',
                title: '大宋断狱神手',
                message: '大宋奇案搅弄朝堂风云'
            }, {
                url: 'images/slide_2.jpg',
                point: '7.5',
                href: 'http://www.iqiyi.com/v_19rr1wzek8.html',
                title: '天下第一镖局',
                message: '樊少皇血战江湖'
            }, {
                url: 'images/slide_3.jpg',
                point: '7.5',
                href: 'http://www.iqiyi.com/v_19rr23yyus.html',
                title: '机甲神七',
                message: '彭禺厶变身钢铁侠'
            }, {
                url: 'images/slide_4.jpg',
                point: '7.3',
                href: 'http://www.iqiyi.com/v_19rqy8y3hw.html',
                title: '狂龙伏妖',
                message: '陈浩民猎妖屠龙'
            }, {
                url: 'images/slide_5.jpg',
                point: '6.2',
                href: 'http://www.iqiyi.com/v_19rr2dsi30.html',
                title: '时间遗墓1：九龙解棺',
                message: '误闯古墓探秘时间旋涡'
            }, {
                url: 'images/slide_6.jpg',
                point: '5.8',
                href: 'http://www.iqiyi.com/v_19rqyamujw.html',
                title: '杀手的自我修养',
                message: '演员真正的职业素养'
            }, {
                url: 'images/slide_7.jpg',
                point: '6.1',
                href: 'http://www.iqiyi.com/v_19rr25qjlc.html',
                title: '异星女物语',
                message: '独特的幽默讽刺喜剧'
            }, {
                url: 'images/slide_8.jpg',
                point: '6.4',
                href: 'http://www.iqiyi.com/v_19rqyoz9is.html',
                title: '荒村之浮生若梦',
                message: '荒村鬼宅地宫探秘'
            }, {
                url: 'images/slide_9.jpg',
                point: '8.1',
                href: 'http://www.iqiyi.com/v_19rr24dq6c.html',
                title: '济公之神龙再现',
                message: '陈浩民逆天改命'
            }, {
                url: 'images/slide_10.jpg',
                point: '7.1',
                href: 'http://www.iqiyi.com/v_19rqz5mhpw.html',
                title: '甩尾王2',
                message: '街头飙车热血追逃'
            }, {
                url: 'images/slide_11.jpg',
                point: '6.5',
                href: 'https://www.iqiyi.com/v_19rr25talc.html',
                title: '艋舺之江湖再现',
                message: '闯荡艋舺的辛酸血泪'
            }, {
                url: 'images/slide_12.jpg',
                point: '6.6',
                href: 'https://www.iqiyi.com/v_19rr1xs2nc.html',
                title: '拯救悟空',
                message: '各路神仙拯救悟空'
            }, {
                url: 'images/slide_13.jpg',
                point: '5.3',
                href: 'https://www.iqiyi.com/v_19rqy4qq68.html',
                title: '战红颜',
                message: '独孤嫣玉龙之间的恩怨情仇'
            }, {
                url: 'images/slide_14.jpg',
                point: '6.3',
                href: 'https://www.iqiyi.com/v_19rr24k208.html',
                title: '美女食人族2喋血金三角',
                message: '误打误撞进入食人族部落'
            }, {
                url: 'images/slide_15.jpg',
                point: '7.2',
                href: 'https://www.iqiyi.com/v_19rqyd3vog.html',
                title: '以为是老大之金三角风云',
                message: '倒霉青年泰国冒险'
            }, {
                url: 'images/slide_16.jpg',
                point: '5.6',
                href: 'https://www.iqiyi.com/v_19rqyc6jq0.html',
                title: '星际密码',
                message: '人类共同抵御邪恶力量'
            }, {
                url: 'images/slide_17.jpg',
                point: '7.3',
                href: 'https://www.iqiyi.com/v_19rr23vn5k.html',
                title: '蜀山降魔传',
                message: '仙魔两界波澜再现'
            } //------------------------------10
        ];



        var data = [data1, data2];
        var itemArr = []; // 存储创建的元素

        var oBox = U.getClass('qy-mod-list');
        for (var i = 0; i < oBox.length; i++) {
            slide(oBox[i], data[i])
        };

        function slide(obj, data) {
            var arrLi = []; //存储所有li
            var numImg = data.length; //一共多少图片
            var W = document.documentElement.clientWidth;
            var imgWidth = 215;
            if (W >= 1700) {
                W = 1700;
            }

            var pageMaxLen = Math.floor(W / imgWidth); //一组放最多图片个数
            obj.style.width = pageMaxLen * imgWidth - 5 + 'px'; //最大宽度
            var lastLen = numImg % imgWidth; //最后一组图片个数
            var count = Math.ceil(numImg / pageMaxLen); //几组

            var n = 0;

            var slideImgLen = 0; // 要运动的图片的个数

            var oUl = U.create('ul');
            for (var i = 0; i < numImg; i++) {
                var oLi = U.create('li');
                var oImg = U.create('img');
                oImg.src = data[i].url;
                var oLDiv = U.create('div');
                oLDiv.className = 'title';
                var oLDDiv = U.create('div');
                oLDDiv.className = 'titMain';
                var oSpan = U.create('span');
                oSpan.innerHTML = data[i].point;
                var oA = U.create('a');
                oA.href = data[i].href;
                oA.innerHTML = data[i].title;
                U.append(oLi, oImg);
                U.append(oLi, oLDiv);
                U.append(oLDiv, oLDDiv);
                U.append(oLDDiv, oSpan);
                U.append(oLDDiv, oA);
                var oH = U.create('h4');
                oH.innerHTML = data[i].message;
                U.append(oLDiv, oH);
                arrLi.push(oLi);
                U.append(oUl, oLi);
            }
            U.append(obj, oUl);

            var btnLeft = U.create('div');
            btnLeft.className = 'j_slider_left';
            btnLeft.style.display = 'none';
            U.append(obj, btnLeft);
            var btnRight = U.create('div');
            btnRight.className = 'j_slider_right';
            U.append(obj, btnRight);


            //上一组
            btnLeft.onclick = function() {
                n--;
                if (n <= 0) {
                    n = 0;
                    btnLeft.style.display = 'none';
                }
                slideImgLen = n * pageMaxLen;
                btnRight.style.display = 'block';
                U.move(oUl, {
                    left: -slideImgLen * imgWidth
                });
            }


            //下一组
            btnRight.onclick = function() {
                n++;
                if (n >= count - 1) {
                    //最后一组
                    if (lastLen) {
                        slideImgLen = numImg - pageMaxLen;
                    } else {
                        slideImgLen = n * pageMaxLen;
                    }
                    btnRight.style.display = 'none';
                } else {
                    slideImgLen = n * pageMaxLen;
                }


                btnLeft.style.display = 'block';
                U.move(oUl, {
                    left: -slideImgLen * imgWidth
                });
            }


            for (var i = 0; i < arrLi.length; i++) {
                arrLi[i].onmouseenter = function() {
                    var that = this;
                    while (itemArr.length) {
                        U.remove(itemArr.pop());
                    };

                    this.timer = setTimeout(function() {
                        var pos = U.getPos(that); //获取滑过的li的位置
                        var left = pos.left;
                        var top = pos.top;
                        var newDiv = U.create('div');
                        newDiv.innerHTML = that.innerHTML;
                        U.removeClass(newDiv, 'title');
                        newDiv.className = 'qy-video-info-tips';
                        newDiv.style.left = left + 'px';
                        newDiv.style.top = top + 'px';
                        newDiv.onmouseleave = function() {
                            if (newDiv) {
                                var find = itemArr.indexOf(newDiv);
                                if (find !== -1) {
                                    U.remove(itemArr.splice(find, 1)[0]);
                                }
                            }
                        }



                        // console.log('left:' + newDiv.style.left + '\ntop:' + newDiv.style.top);
                        itemArr.push(newDiv);
                        U.append(document.body, newDiv);


                        U.move(newDiv, {
                            width: 250,
                            height: 361,
                            top: top - 13,
                            left: left - 20
                        });


                    }, 500);
                }
                arrLi[i].onmouseleave = function() {
                    clearTimeout(this.timer);
                }
            }

        }
    }



)();